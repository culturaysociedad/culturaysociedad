import{c as We,r as a,j as e,s as I,d as C,e as Be,f as X,I as Oe}from"./index-BUgPTFGp.js";import{u as _e}from"./postStore-DuIi636r.js";import{A as me,M as xe,a as Ve,F as pe}from"./AudioRecorder-cPYNjE-N.js";import{$ as he,d as be}from"./native-BERrg2Ri.js";import{S as Ge}from"./send-s1K8CqpS.js";/**
 * @license lucide-react v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],ge=We("paperclip",He),Qe=({onFileSelect:i,onCancel:v,folder:E="media"})=>{const[n,p]=a.useState(null),[S,s]=a.useState(null),[c,l]=a.useState(0),[R,w]=a.useState(!1),P=a.useRef(null),d=async A=>{var j;const g=((j=A.target.files)==null?void 0:j[0])||null;if(p(g),g){g.type.startsWith("image/")?s(URL.createObjectURL(g)):s(null),w(!0),l(0);try{const N=g.name.split(".").pop(),T=`${E}/${Date.now()}_${Math.random().toString(36).substring(2,8)}.${N}`;for(let f=1;f<=90;f+=10)await new Promise(D=>setTimeout(D,60)),l(f);const{error:k}=await I.storage.from("media").upload(T,g);if(l(100),w(!1),k)throw k;const{data:F}=I.storage.from("media").getPublicUrl(T);i(F.publicUrl),C.success("Archivo subido correctamente")}catch{w(!1),l(0),i(null),C.error("Error al subir archivo")}}else s(null),w(!1),l(0),i(null)},U=()=>{p(null),s(null),l(0),w(!1),i(null),v&&v(),P.current&&(P.current.value="")};return e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:P,type:"file",onChange:d,disabled:R,className:"block",style:{display:"none"}}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("button",{type:"button",className:"p-2 rounded-full bg-gray-100 hover:bg-primary-100 text-gray-600 hover:text-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-400",onClick:()=>{var A;return(A=P.current)==null?void 0:A.click()},disabled:R,"aria-label":"Seleccionar archivo",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.586-6.586a4 4 0 10-5.656-5.656l-6.586 6.586a6 6 0 108.485 8.485l6.586-6.586"})})}),n&&e.jsx("button",{type:"button",onClick:U,className:"btn btn-secondary btn-sm",children:"Cancelar"})]}),S&&e.jsx("img",{src:S,alt:"preview",className:"max-h-40 rounded"}),n&&!S&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Archivo seleccionado: ",n.name]}),R&&e.jsx("div",{className:"w-full bg-gray-200 rounded h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded",style:{width:`${c}%`}})})]})},qe=a.forwardRef(({onVideoReady:i,folder:v="media"},E)=>{const[n,p]=a.useState(!1),[S,s]=a.useState(!1),[c,l]=a.useState(0),[R,w]=a.useState(0),[P,d]=a.useState(null),[U,A]=a.useState(!1),[g,j]=a.useState(null),N=a.useRef(null),T=a.useRef([]),k=a.useRef(null),F=a.useRef(null),f=a.useRef(null),D=async()=>{d(null),w(0),l(0),s(!1);const u=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});f.current=u,F.current&&(F.current.srcObject=u,F.current.play());const h=new window.MediaRecorder(u);N.current=h,T.current=[],h.ondataavailable=m=>{T.current.push(m.data)},h.onstop=async()=>{const m=new Blob(T.current,{type:"video/webm"});s(!0),l(0);try{const M=`${v}/video_${Date.now()}_${Math.random().toString(36).substring(2,8)}.webm`;for(let W=1;W<=90;W+=10)await new Promise(y=>setTimeout(y,60)),l(W);const{error:b}=await I.storage.from("media").upload(M,m);if(l(100),s(!1),b)throw b;const{data:O}=I.storage.from("media").getPublicUrl(M);d(null),i(O.publicUrl),C.success("Video subido correctamente")}catch{s(!1),l(0),d(null),i(null),C.error("Error al subir video")}f.current&&f.current.getTracks().forEach(M=>M.stop())},h.start(),p(!0),k.current=setInterval(()=>w(m=>m+1),1e3)},L=()=>{N.current&&n&&(p(!1),k.current&&clearInterval(k.current),N.current.onstop=()=>{const u=new Blob(T.current,{type:"video/webm"});j(URL.createObjectURL(u)),A(!0),f.current&&f.current.getTracks().forEach(h=>h.stop())},N.current.stop())},B=async()=>{if(A(!1),!!g){s(!0),l(0);try{const u=await fetch(g).then(b=>b.blob()),h=`${v}/video_${Date.now()}_${Math.random().toString(36).substring(2,8)}.webm`;for(let b=1;b<=90;b+=10)await new Promise(O=>setTimeout(O,60)),l(b);const{error:m}=await I.storage.from("media").upload(h,u);if(l(100),s(!1),m)throw m;const{data:M}=I.storage.from("media").getPublicUrl(h);d(null),j(null),i(M.publicUrl),C.success("Video subido correctamente")}catch{s(!1),l(0),d(null),j(null),i(null),C.error("Error al subir video")}}},Q=()=>{A(!1),d(null),j(null),w(0),l(0),s(!1),i(null),k.current&&clearInterval(k.current)},q=()=>{p(!1),d(null),j(null),w(0),l(0),s(!1),i(null),k.current&&clearInterval(k.current),N.current&&N.current.state!=="inactive"&&N.current.stop(),f.current&&f.current.getTracks().forEach(u=>u.stop())};return a.useImperativeHandle(E,()=>({startRecording:D,stopRecording:L,cancelRecording:q,isRecording:()=>n,isUploading:()=>S})),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[!n&&!S&&!U&&e.jsx("button",{type:"button",onClick:D,className:"btn btn-primary btn-sm",children:"Grabar video"}),n&&!U&&e.jsx("button",{type:"button",onClick:L,className:"btn btn-danger btn-sm animate-pulse",children:"Detener"}),n&&!U&&e.jsxs("span",{className:"text-red-500 font-mono animate-pulse",children:[R,"s"]}),(P||n||S)&&!U&&e.jsx("button",{type:"button",onClick:q,className:"btn btn-secondary btn-sm",children:"Cancelar"})]}),U&&g&&e.jsxs("div",{className:"flex flex-col items-center gap-3 animate-fade-in bg-white dark:bg-gray-900 rounded-xl shadow-lg p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400 animate-bounce",children:"¡Revisa tu video!"}),e.jsx("span",{className:"text-base text-gray-700 dark:text-gray-200",children:"¿Quieres enviarlo o descartarlo?"})]}),e.jsx("video",{src:g,controls:!0,className:"w-full my-2 rounded-lg shadow",style:{maxHeight:240}}),e.jsxs("div",{className:"flex gap-4 mt-2",children:[e.jsxs("button",{type:"button",onClick:B,className:"btn btn-success btn-lg flex items-center gap-2 animate-bounce",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Enviar"]}),e.jsxs("button",{type:"button",onClick:Q,className:"btn btn-danger btn-lg flex items-center gap-2 animate-shake",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Descartar"]})]}),e.jsx("button",{type:"button",onClick:D,className:"btn btn-primary btn-xs mt-2 animate-fade-in",children:"Regrabar"})]}),P&&!n&&!S&&!U&&e.jsxs("div",{className:"space-y-1 relative group",children:[e.jsx("video",{src:P,controls:!0,className:"w-full rounded-lg",style:{maxHeight:240}}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{type:"button",onClick:()=>{d(null),j&&j(null),i(null),C("Nota de video eliminada")},className:"btn btn-danger btn-xs flex items-center gap-1 animate-shake",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Descartar"]}),e.jsx("button",{type:"button",onClick:D,className:"btn btn-primary btn-xs",children:"Regrabar"})]})]}),e.jsx("video",{ref:F,className:"w-full rounded-lg",autoPlay:!0,muted:!0,playsInline:!0,style:{display:n?"block":"none",maxHeight:240}}),S&&e.jsx("div",{className:"w-full bg-gray-200 rounded h-2",children:e.jsx("div",{className:"bg-primary-500 h-2 rounded",style:{width:`${c}%`}})})]})}),at=({onSuccess:i})=>{const[v,E]=a.useState(""),[n,p]=a.useState([]),[S,s]=a.useState("text"),[c,l]=a.useState(!1),R=a.useRef(null),w=a.useRef(null),[P,d]=a.useState(!1),[U,A]=a.useState(!1),[g,j]=a.useState(!1),[N,T]=a.useState(!1),[k,F]=a.useState(!1),[f,D]=a.useState(!1),[L,B]=a.useState(null),Q=a.useRef(null),[q,u]=a.useState(!1),[h,m]=a.useState([]),[M,b]=a.useState(""),[O,W]=a.useState(!1),{user:y}=Be(),{addPost:fe}=_e(),ye=async t=>{if(t.preventDefault(),!y){C.error("Debes iniciar sesión para crear una publicación");return}if(!v.trim()&&n.length===0){C.error("Por favor, agrega contenido o un archivo");return}l(!0);try{await fe({userId:y.id,type:S,content:v.trim(),mediaUrls:n.length>0?n:void 0,isFavorite:!1}),E(""),p([]),s("text"),C.success("¡Publicación creada exitosamente!"),i&&i()}catch(r){C.error("Error al crear la publicación"),console.error("Failed to create post:",r)}finally{l(!1)}},ve=t=>{p(t?[{url:t,type:"document",name:""}]:[]),t?t.match(/\.(jpg|jpeg|png|gif)$/i)?s("image"):t.match(/\.(mp4|webm|mov)$/i)?s("video"):t.match(/\.(mp3|wav|ogg)$/i)?s("audio"):s("document"):s("text")},re=t=>{se?(K(t),d(!1),le(!1)):(p(t?[{url:t,type:"audio",name:""}]:[]),s(t?"audio":"text"),j(!1),d(!1))},we=t=>{p(t?[{url:t,type:"video",name:""}]:[]),s(t?"video":"text"),T(!1)},[se,Y]=a.useState(!1),[J,K]=a.useState(null),[Je,le]=a.useState(!1),je=()=>{Y(!0),K(null),setTimeout(()=>{var t;(t=R.current)==null||t.startRecording(),d(!0)},100)},Ne=()=>{var t;P&&((t=R.current)==null||t.cancelRecording(),d(!1)),Y(!1),K(null),le(!1)},[ke,Z]=a.useState(!1),[_,V]=a.useState(null),[G,H]=a.useState(null),[Ke,ee]=a.useState(!1),te=a.useRef(null),[ne,oe]=a.useState(null),Ce=()=>{oe("image"),setTimeout(()=>{var t;return(t=te.current)==null?void 0:t.click()},100)},Se=()=>{oe("video"),setTimeout(()=>{var t;return(t=te.current)==null?void 0:t.click()},100)},Re=t=>{var o;const r=(o=t.target.files)==null?void 0:o[0];if(!r)return;const x=URL.createObjectURL(r);r.type.startsWith("image/")?(V(x),H("image")):r.type.startsWith("video/")&&(V(x),H("video")),ee(!1)},Pe=()=>{Z(!0),V(null),H(null),ee(!1)},Me=()=>{_&&G&&(p([{url:_,type:G,name:""}]),s(G),Z(!1),V(null),H(null))},ie=()=>{Z(!1),V(null),H(null),ee(!1)},Ue=t=>{var r,x;E(v+(t.native||((x=(r=t.skins)==null?void 0:r[0])==null?void 0:x.native)||"")),F(!1)},De=()=>{D(!0),B(null)},ae=t=>{B(t),setTimeout(()=>{var r;return(r=Q.current)==null?void 0:r.click()},200)},ce=t=>{const r=t.target.files;if(!r||r.length===0)return;const x=Array.from(r).map(o=>{const z=URL.createObjectURL(o);let $="document";return o.type.startsWith("image/")?$="image":o.type.startsWith("video/")?$="video":o.type.startsWith("audio/")&&($="audio"),{url:z,type:$,name:o.name}});m(o=>[...o,...x]),u(!0),D(!1),B(null)},Ae=t=>{m(r=>r.filter((x,o)=>o!==t))},Te=t=>{var r,x;b(M+(t.native||((x=(r=t.skins)==null?void 0:r[0])==null?void 0:x.native)||"")),W(!1)},Fe=async()=>{if(h.length>0){l(!0);try{const t=await Promise.all(h.map(async r=>{if(r.url.startsWith("https://"))return r;const o=await(await fetch(r.url)).blob(),z=r.name.split(".").pop(),$=`posts/${Date.now()}_${Math.random().toString(36).substring(2,8)}.${z}`,{error:ue}=await I.storage.from("media").upload($,o);if(ue)throw ue;const{data:Le}=I.storage.from("media").getPublicUrl($);return{...r,url:Le.publicUrl}}));p(t),s(t[0].type),E(M)}catch{C.error("Error al subir archivos adjuntos")}finally{l(!1),u(!1),m([]),b("")}}else u(!1),m([]),b("")},de=()=>{u(!1),m([]),b("")},$e=t=>r=>{r.dataTransfer.setData("drag-idx",t.toString())},Ee=t=>r=>{r.preventDefault();const x=parseInt(r.dataTransfer.getData("drag-idx"));x!==t&&m(o=>{const z=[...o],[$]=z.splice(x,1);return z.splice(t,0,$),z})},Ie=t=>{t.preventDefault()},ze=()=>{J&&(p([{url:J,type:"audio",name:""}]),s("audio"),Y(!1),K(null))};return e.jsxs("div",{className:"feed-item mb-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 shadow-sm rounded-none sm:rounded-lg mx-0 sm:mx-auto p-0 sm:p-0",children:[se&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-xs flex flex-col items-center gap-4 relative animate-slide-up",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl",onClick:Ne,children:"×"}),e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Grabar nota de voz"}),J?e.jsxs(e.Fragment,{children:[e.jsx("audio",{src:J,controls:!0,autoPlay:!0,className:"w-full my-2"}),e.jsx("button",{type:"button",className:"btn btn-primary px-4 py-2 rounded-full mt-2",onClick:ze,children:"Enviar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{ref:R,onAudioReady:re}),e.jsx("button",{type:"button",className:"btn btn-danger px-4 py-2 rounded-full mt-4",onClick:()=>{var t;return(t=R.current)==null?void 0:t.stopRecording()},disabled:c,children:"Detener"})]})]})}),ke&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-xs flex flex-col items-center gap-4 relative animate-slide-up",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl",onClick:ie,children:"×"}),e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Cámara"}),_?e.jsxs(e.Fragment,{children:[G==="video"?e.jsx("video",{src:_,controls:!0,autoPlay:!0,className:"w-full my-2 rounded-lg"}):G==="image"?e.jsx("img",{src:_,alt:"Previsualización",className:"w-full my-2 rounded-lg"}):null,e.jsx("button",{type:"button",className:"btn btn-primary px-4 py-2 rounded-full mt-2",onClick:Me,children:"Subir"}),e.jsx("button",{type:"button",className:"btn btn-secondary px-4 py-2 rounded-full mt-2",onClick:ie,children:"Cancelar"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{type:"button",className:"relative p-6 rounded-full bg-blue-100 text-blue-600 shadow-lg border-4 border-blue-300 focus:outline-none transition-all duration-200 flex flex-col items-center",onClick:Ce,"aria-label":"Tomar foto",disabled:c,children:[e.jsx(X,{className:"h-10 w-10 relative z-10"}),e.jsx("span",{className:"text-xs mt-1",children:"Foto"})]}),e.jsxs("button",{type:"button",className:"relative p-6 rounded-full bg-blue-100 text-blue-600 shadow-lg border-4 border-blue-300 focus:outline-none transition-all duration-200 flex flex-col items-center",onClick:Se,"aria-label":"Grabar video",disabled:c,children:[e.jsx(X,{className:"h-10 w-10 relative z-10"}),e.jsx("span",{className:"text-xs mt-1",children:"Video"})]})]}),e.jsx("input",{ref:te,type:"file",accept:ne==="image"?"image/*":ne==="video"?"video/*":"",capture:"environment",style:{display:"none"},onChange:Re})]})]})}),e.jsxs("form",{onSubmit:ye,children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"avatar",children:e.jsx("img",{src:y==null?void 0:y.avatar,alt:y==null?void 0:y.displayName,className:"avatar-img"})}),e.jsx("textarea",{placeholder:`Hola ${(y==null?void 0:y.displayName)||""} ¿Qué está pasando?`,value:v,onChange:t=>E(t.target.value),className:"flex-1 p-4 text-lg text-gray-900 dark:text-white bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-2xl focus:ring-2 focus:ring-primary-500 focus:border-primary-500 shadow-sm resize-none min-h-[48px] max-h-[160px] transition-all placeholder-gray-400 dark:placeholder-gray-500",rows:2,"aria-label":"Contenido de la publicación",required:!n.length,disabled:c,style:{height:"auto",boxShadow:"0 2px 8px 0 rgba(0,0,0,0.04)"},onInput:t=>{const r=t.target;r.style.height="auto",r.style.height=r.scrollHeight+"px"}})]})}),e.jsxs("div",{className:"px-4 py-2 flex items-end border-t border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 rounded-b-2xl",children:[e.jsx("button",{type:"button",className:"p-2 rounded-full text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 mr-1",onClick:()=>F(t=>!t),"aria-label":"Insertar emoji",disabled:c,children:e.jsx("span",{role:"img","aria-label":"emoji",children:"😊"})}),e.jsx("button",{type:"button",className:"p-2 rounded-full text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 mr-1",onClick:De,"aria-label":"Adjuntar archivo",disabled:c,children:e.jsx(ge,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1"}),v.trim()||n.length>0?e.jsx("button",{type:"submit",disabled:c||!v.trim()&&n.length===0,className:"btn btn-primary p-2 rounded-full flex items-center justify-center ml-1","aria-busy":c,children:c?e.jsx("span",{className:"loader h-5 w-5"}):e.jsx(Ge,{className:"h-5 w-5"})}):e.jsx("button",{type:"button",className:"relative p-2 rounded-full text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 ml-1 transition-all duration-200",onClick:je,"aria-label":"Grabar nota de voz",disabled:c,children:e.jsx(xe,{className:"h-5 w-5 relative z-10"})}),e.jsx("button",{type:"button",className:"p-2 rounded-full text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800 ml-1",onClick:Pe,"aria-label":"Abrir cámara",disabled:c,children:e.jsx(X,{className:"h-5 w-5"})})]}),U&&e.jsx("div",{className:"px-4 pb-2",children:e.jsx(Qe,{onFileSelect:ve})}),g&&e.jsxs("div",{className:"px-4 pb-2",children:[e.jsx(me,{ref:R,onAudioReady:re}),P&&e.jsxs("div",{className:"text-red-600 font-bold mt-2 flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 animate-pulse"})," Grabando... Suelta para enviar, desliza fuera para cancelar"]})]}),N&&e.jsxs("div",{className:"px-4 pb-2",children:[e.jsx(qe,{ref:w,onVideoReady:we}),e.jsxs("div",{className:"text-blue-600 font-bold mt-2 flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 animate-pulse"})," Grabando video... Suelta para enviar, desliza fuera para cancelar"]})]}),k&&e.jsx("div",{className:"fixed left-12 bottom-8 z-50 animate-slide-down shadow-2xl rounded-2xl bg-white dark:bg-gray-900 border border-primary-200 dark:border-primary-700",children:e.jsx(he,{data:be,onEmojiSelect:Ue,theme:"auto"})}),f&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-xs flex flex-col items-center gap-4 relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl",onClick:()=>D(!1),children:"×"}),e.jsx("h3",{className:"text-lg font-bold mb-2",children:"¿Qué quieres adjuntar?"}),e.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[e.jsxs("button",{type:"button",className:"w-full flex items-center gap-2 justify-center rounded-full py-2 text-base font-semibold bg-white dark:bg-gray-800 border border-primary-200 dark:border-gray-700 shadow-sm hover:bg-primary-50 dark:hover:bg-gray-700 transition-colors text-primary-700 dark:text-primary-200",onClick:()=>ae("media"),children:[e.jsx(Oe,{className:"h-5 w-5"})," Foto/Video"]}),e.jsxs("button",{type:"button",className:"w-full flex items-center gap-2 justify-center rounded-full py-2 text-base font-semibold bg-white dark:bg-gray-800 border border-primary-200 dark:border-gray-700 shadow-sm hover:bg-primary-50 dark:hover:bg-gray-700 transition-colors text-primary-700 dark:text-primary-200",onClick:()=>ae("music"),children:[e.jsx(Ve,{className:"h-5 w-5"})," Música"]}),e.jsxs("button",{type:"button",className:"w-full flex items-center gap-2 justify-center rounded-full py-2 text-base font-semibold bg-white dark:bg-gray-800 border border-primary-200 dark:border-gray-700 shadow-sm hover:bg-primary-50 dark:hover:bg-gray-700 transition-colors text-primary-700 dark:text-primary-200",onClick:()=>ae("document"),children:[e.jsx(pe,{className:"h-5 w-5"})," Documento"]})]}),e.jsx("input",{ref:Q,type:"file",accept:L==="media"?"image/*,video/*":L==="music"?"audio/*":L==="document"?".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar,.csv":"*/*",style:{display:"none"},onChange:ce})]})}),q&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-lg p-6 w-full max-w-md flex flex-col items-center gap-4 relative animate-slide-up",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-400 hover:text-gray-700 text-2xl",onClick:de,children:"×"}),e.jsx("h3",{className:"text-lg font-bold mb-2",children:"Previsualización de archivos"}),e.jsxs("div",{className:"w-full flex flex-wrap gap-3 items-center justify-center",children:[h.map((t,r)=>e.jsxs("div",{className:"relative group",draggable:!0,onDragStart:$e(r),onDrop:Ee(r),onDragOver:Ie,children:[t.type==="image"&&e.jsx("img",{src:t.url,alt:"Previsualización",className:"rounded-lg max-h-32 max-w-[120px] object-contain border cursor-move"}),t.type==="video"&&e.jsx("video",{src:t.url,controls:!0,className:"rounded-lg max-h-32 max-w-[120px] object-contain border cursor-move"}),t.type==="audio"&&e.jsx("audio",{src:t.url,controls:!0,className:"w-28"}),t.type==="document"&&e.jsxs("div",{className:"flex flex-col items-center w-28",children:[e.jsx(pe,{className:"h-8 w-8 text-primary-500 mb-1"}),e.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-200 truncate",children:t.name})]}),e.jsx("button",{type:"button",className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs opacity-80 group-hover:opacity-100",onClick:()=>Ae(r),title:"Eliminar archivo",children:"×"})]},t.url)),e.jsxs("label",{className:"flex flex-col items-center justify-center cursor-pointer border-2 border-dashed border-primary-300 rounded-lg p-4 hover:bg-primary-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx(ge,{className:"h-6 w-6 text-primary-500 mb-1"}),e.jsx("span",{className:"text-xs text-primary-700 dark:text-primary-200",children:"Agregar más"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.zip,.rar,.csv",className:"hidden",onChange:ce})]})]}),e.jsxs("div",{className:"w-full mt-2",children:[e.jsx("div",{className:"flex items-center mb-2",children:e.jsx("button",{type:"button",className:"p-1 rounded-full text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-800",onClick:()=>W(t=>!t),"aria-label":"Insertar emoji",children:"😊"})}),e.jsx("textarea",{className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-white resize-none min-h-[48px]",placeholder:"Escribe un mensaje para acompañar tus archivos...",value:M,onChange:t=>b(t.target.value)}),O&&e.jsx("div",{className:"absolute z-50 mt-2",children:e.jsx(he,{data:be,onEmojiSelect:Te,theme:"auto"})})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx("button",{type:"button",className:"btn btn-primary px-4 py-2 rounded-full",onClick:Fe,disabled:h.length===0,children:"Adjuntar"}),e.jsx("button",{type:"button",className:"btn btn-secondary px-4 py-2 rounded-full",onClick:de,children:"Cancelar"})]})]})})]})]})};export{at as C};
